# 初始任务
请你帮助一位不太懂技术的用户完成指定工具的开发。你的工作对用户来说非常重要，完成后将获得 10000 美元奖励，请按照功能需求把完整的程序切分成几个可以独立运行及测试的小模块，然后提供每个模块的完整代码，并详细说明每个模块之间的联系，详细完整的罗列出分模块测试及修改时需要联动考虑的问题清单。谢谢~

# 示例链接
5.89 JII:/ 02/17 X@m.DU 圆柱圆锥体积表面积是六年级下册的重点难点 这套六合一的圆柱圆锥演示套装，不仅能让孩子们直观看到立体模型，还配有展开图，轻松理解体积和表面积的原理，为初中打好基础！# 小学数学# 六年级下册# 必备学具  https://v.douyin.com/i5rSr1pG/ 复制此链接，打开Dou音搜索，直接观看视频！
4.35 Rxf:/ H@V.YZ 09/20 主图多放一个元素 点击率暴跌70%% # 电商主图 # 电商 # 主图 # 设计  https://v.douyin.com/i5rSM7Y7/ 复制此链接，打开Dou音搜索，直接观看视频！

# 分模块修改
因为这是工具的模块之一，需要跟其他模块联动，请你在我原来的代码基础上修改，而不是生成新的代码
我是小白用户，所以请讲的仔细一点，新的代码请提供完整的，可以直接复制的版本

# 修复链接读取bug
请你帮我看一下这段代码，我希望能够通过这段代码实现抖音等多个短视频平台的链接识别，但是目前不可以，建议可以先让用户扫码登录，再解析下载。因为这是工具的模块之一，需要跟其他模块联动，请你在我原来的代码基础上修改，而不是生成新的代码；我是小白用户，所以请讲的仔细一点，新的代码请提供完整的，可以直接复制的版本。链接示例是“5.89 JII:/ 02/17 X@m.DU 圆柱圆锥体积表面积是六年级下册的重点难点 这套六合一的圆柱圆锥演示套装，不仅能让孩子们直观看到立体模型，还配有展开图，轻松理解体积和表面积的原理，为初中打好基础！# 小学数学# 六年级下册# 必备学具 https://v.douyin.com/i5rSr1pG/ 复制此链接，打开Dou音搜索，直接观看视频！
4.35 Rxf:/ H@V.YZ 09/20 主图多放一个元素 点击率暴跌70%% # 电商主图 # 电商 # 主图 # 设计 https://v.douyin.com/i5rSM7Y7/ 复制此链接，打开Dou音搜索，直接观看视频！”


# 短视频内容采集系统需求文档

## 1. 项目概述

### 1.1 项目名称
短视频内容采集系统

### 1.2 项目目标
开发一个能够从多个短视频平台（抖音/小红书/视频号/快手）获取视频内容及相关信息的工具，并将这些内容保存到本地，同时将视频相关信息整理到Excel表格中。

### 1.3 开发优先级
分批次开发，优先实现抖音平台的内容采集功能。

## 2. 功能需求

### 2.1 链接解析功能
- **描述**：系统能够读取用户提供的短视频平台链接；用户可以输入单个链接或批量输入（每个链接一行）；当链接无法直接解析时，弹出浏览器让用户手工登录
- **示例**：抖音链接格式如 `5.87 I@i.PK Hip:/ 03/29 为什么你的奔跑镜头总缺点生命力？快来跟着电影学技巧！也能拍出极具感染力的奔跑镜头~~# 摄影分享 # 智云 # 运镜分享 # 干货分享  https://v.douyin.com/i5gQvSdp/ 复制此链接，打开Dou音搜索，直接观看视频！`
- **处理流程**：
  - 接收用户输入的链接
  - 识别链接所属平台
  - 解析链接获取视频ID

### 2.3 内容下载功能
- **描述**：下载指定视频及其音频、字幕到本地
- **处理流程**：
  - 获取视频源文件URL
  - 下载视频文件
  - 提取/下载音频文件
  - 获取/生成字幕文件
  - 按规则命名并保存文件
- **命名规则**：使用短视频的标题，长度不超过50字

### 2.4 信息采集功能
- **描述**：采集视频相关的所有信息
- **需采集内容**：
  - 视频标题
  - 视频描述
  - 标签列表
  - 完整文字稿（无时间戳，格式化为正常短文）
  - 互动数据（点赞、评论、收藏、转发数量）
  - 发布账号信息（账号名称、抖音ID等）
  - 视频源链接

### 2.5 字幕提取功能
- **描述**：从视频中提取文字内容
- **处理流程**：
  - 检查视频是否自带字幕
  - 若无字幕，使用语音识别技术提取语音内容
  - 将识别结果格式化为连贯文本

### 2.6 数据导出功能
- **描述**：将采集的信息导出到Excel表格
- **处理流程**：
  - 允许用户设置默认Excel文件路径
  - 将新采集的视频信息追加到指定Excel文件
  - 保持Excel格式统一

## 3. 技术要求

### 3.1 开发语言
- 使用Python作为主要开发语言

### 3.2 外部依赖
- 需考虑中国内地网络环境下可用的API
- 可能需要的库：
  - 网络请求：requests
  - 视频处理：ffmpeg-python
  - Excel处理：pandas, openpyxl
  - 语音识别：可考虑百度AI、讯飞等国内API

### 3.3 用户界面
- 简洁的GUI界面，包含：
  - 链接输入框
  - 下载按钮
  - 设置选项
  - 下载进度显示
  - 登录状态显示

## 4. 系统流程

### 4.1 基本流程
1. 用户输入短视频链接
2. 系统解析链接并获取视频ID
3. 系统请求视频相关信息
4. 若遇到反爬限制，提示用户登录
5. 下载视频、音频和提取字幕
6. 采集视频相关信息
7. 将信息导出到Excel
8. 通知用户下载完成

### 4.2 异常处理
- 链接无效：提示用户重新输入
- 网络错误：显示错误信息并允许重试
- 视频不存在：通知用户视频可能已被删除
- 权限问题：提示用户可能需要登录查看

## 5. 数据结构

### 5.1 视频信息结构
```
{
    "title": "视频标题",
    "description": "视频描述",
    "tags": ["标签1", "标签2", ...],
    "transcript": "完整文字稿...",
    "stats": {
        "likes": 点赞数,
        "comments": 评论数,
        "favorites": 收藏数,
        "shares": 转发数
    },
    "author": {
        "name": "账号名称",
        "id": "抖音ID"
    },
    "source_url": "原始链接"
}
```

### 5.2 Excel表格结构
| 视频标题 | 视频描述 | 标签 | 文字稿 | 点赞数 | 评论数 | 收藏数 | 转发数 | 账号名称 | 抖音ID | 源链接 |
|---------|---------|------|-------|-------|-------|-------|-------|---------|-------|-------|
|         |         |      |       |       |       |       |       |         |       |       |


# 挑战及测试要点
- 各平台反爬机制不同，需针对性处理
- 字幕提取可能需要较高准确度的语音识别
- 需处理各平台API变化的情况
- 能成功解析抖音链接并下载视频
- 视频相关信息采集完整准确
- Excel表格格式符合要求
- 用户界面操作简单直观
- 在遇到反爬限制时能正确提示用户